version: "3.3"

services:
  backend:
    build: ./backend
    container_name: tp-backend
    ports:
      - "3000:3000" # Hôte : Conteneur (Backend accessible sur localhost:3000)
    networks:
      - webnet
    environment:
      # Database connection should be provided via .env file or environment variables
      # For local development, use external PostgreSQL or Render database
      - DB_HOST=${DB_HOST}
      - DB_PORT=${DB_PORT:-5432}
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_NAME=${DB_NAME}
      - DB_SSL=${DB_SSL:-false}

  frontend:
    build: ./frontend
    container_name: tp-frontend
    ports:
      - "8080:80" # Frontend accessible sur localhost:8080
    depends_on:
      - backend
    networks:
      - webnet

networks:
  webnet: # Réseau bridge personnalisé pour communication